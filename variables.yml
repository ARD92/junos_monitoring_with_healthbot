#############################################################################
# note: update these variables, don't change the data structure. 
#############################################################################

#############################################################################
# healthbot host and credentials
#############################################################################
server: "10.49.102.129"
authuser: "admin"
authpwd: "Embe1mpls"


#############################################################################
# network devices details to add to healthbot
#############################################################################
devices_list:
    - authentication:
          password:
              password: "Embe1mpls"
              username: "root"
      description: "vmx101"
      device-id: "vmx101"
      host: "10.49.102.160"
      iAgent:
          port: 830
      open-config:
          port: 32768
      system-id: "vmx101"
    - authentication:
          password:
              password: "Embe1mpls"
              username: "root"
      description: "vmx102"
      device-id: "vmx102"
      host: "10.49.102.157"
      iAgent:
          port: 830
      open-config:
          port: 32768
      system-id: "vmx102"
    - authentication:
          password:
              password: "Embe1mpls"
              username: "root"
      description: "vmx103"
      device-id: "vmx103"
      host: "10.49.102.151"
      iAgent:
          port: 830
      open-config:
          port: 32768
      system-id: "vmx103"
    - authentication:
          password:
              password: "Embe1mpls"
              username: "root"
      description: "vmx104"
      device-id: "vmx104"
      host: "10.49.102.148"
      iAgent:
          port: 830
      open-config:
          port: 32768
      system-id: "vmx104"
    - authentication:
          password:
              password: "Embe1mpls"
              username: "root"
      description: "vmx105"
      device-id: "vmx105"
      host: "10.49.102.142"
      iAgent:
          port: 830
      open-config:
          port: 32768
      system-id: "vmx105"
    - authentication:
          password:
              password: "Embe1mpls"
              username: "root"
      description: "vmx106"
      device-id: "vmx106"
      host: "10.49.102.140"
      iAgent:
          port: 830
      open-config:
          port: 32768
      system-id: "vmx106"
    - authentication:
          password:
              password: "Embe1mpls"
              username: "root"
      description: "vmx107"
      device-id: "vmx107"
      host: "10.49.102.136"
      iAgent:
          port: 830
      open-config:
          port: 32768
      system-id: "vmx107"


#############################################################################
# tables and views to load on healthbot (from the directory tables_and_views)
#############################################################################
tables_and_views:
    - bgp_sessions_state.yml
    - ospf.yml


#############################################################################
# notifications to add to healthbot
#############################################################################
notifications:
    - notification-name: heathbot_to_saltstack
      description: "heathbot to saltstack webhook notifications"
      http-post:
          url: http://10.49.102.129:5001/healthbot
    - notification-name: another_notification
      description: another_notification
      http-post:
          url: http://10.49.102.129:5001/healthbot


#############################################################################
# topics to add to healthbot
#############################################################################
topics:
    - topic-name: protocol.bgp
      synopsis:  monitor bgp
      description: This topic is to monitors bgp details
    - topic-name: test.test
      synopsis:  test
      description: test


#############################################################################
# rules to add to healthbot
#############################################################################
rules: 
    - field: 
        - description: peer-address
          field-name: peer-address
          sensor: 
              - path: peer-address
                sensor-name: session_state
          type: string
        - description: state
          field-name: state
          sensor: 
              - path: peer_state
                sensor-name: session_state
          type: string
      keys: 
        - peer-address
      rule-name: ast
      sensor: 
        - iAgent: 
              file: bgp_sessions_state.yml
              frequency: 15s
              table: bgpTable
          sensor-name: session_state
      trigger: 
        - frequency: 30s
          term: 
              - term-name: is-establish
                then: 
                    status:
                        color: green
                when: 
                    matches-with: 
                        - left-operand: $state
                          right-operand: Established
              - term-name: is_not_established
                then: 
                    status: 
                        color: red
          trigger-name: neighborship
      variable: 
        - description: Enter neighbor name or address using regular expression
          name: neighbors
          type: string
          value: .*

#############################################################################
# playbook to add to healthbot
#############################################################################
playbooks:
     - playbook-name: ast
       description: ast
       synopsis: ast
       rules: 
          - protocol.bgp/ast
     - playbook-name: pb123
       description: pb123
       synopsis: pb123
       rules: 
          - protocol.bgp/ast
          - protocol.bgp/check-bgp-route-flap-damping


#############################################################################
# device groups details to add to healthbot
#############################################################################
device_groups:
    - description: Group1
      device-group-name: Group1
      devices:
           - vmx101
           - vmx102
           - vmx103
           - vmx104
           - vmx105
           - vmx106
           - vmx107
      playbooks:
           - ast
      notification:
          major:
              - heathbot_to_saltstack
              - another_notification
          minor:
              - another_notification
      variable:
          - instance-id: ast1
            playbook: ast
            rule: protocol.bgp/ast
            variable-value: 
                - name: neighbors
                  value: ge-0/0/*

    - description: Group2
      device-group-name: Group2
      devices:
           - vmx103
           - vmx104

